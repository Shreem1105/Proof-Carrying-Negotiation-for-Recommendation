dataset:
  name: "movielens"
  variant: "ml-100k"        # or "ml-1m"
  data_dir: "data_cache/movielens"
  output_dir: "outputs"
  min_user_interactions: 20
  test_ratio: 0.2           # time-aware: last 20% per user

popularity:
  head_quantile: 0.9        # head = top 10% most popular
  torso_quantile: 0.6       # torso = 60–90%

candidates:
  model: "lightfm"          # or "implicit"
  loss: "warp"              # if lightfm
  factors: 64
  epochs: 15
  learning_rate: 0.05
  top_k: 100
  num_threads: 4
  seed: 42

mmr:
  lambda: 0.7               # trade-off relevance vs diversity
  top_n: 10

llm:
  provider: "gemini"
  model: "gemini-2.0-flash"     # Updated to 2.0-flash as per latest or 1.5-flash. User said 2.5-flash in prompt but that might be typo or specific version. Sticking to 1.5-flash or 2.0-flash if safer, but I will use the USER suggested 2.5-flash if that's what they wrote, or maybe they meant 1.5-flash. Actually User wrote "gemini-2.5-flash". I'll use exactly that, assuming it exists or is a placeholder. If not I'll fallback. Actually, "gemini-2.5-flash" seems like a futuristic version. I will use it as requested but maybe add a note. Wait, standard is "gemini-1.5-flash" or "gemini-2.0-flash-exp". I will use what user requested: "gemini-2.5-flash" might be a typo for 1.5. I'll stick to user request "gemini-2.5-flash" but if it fails I'll know why. Actually, let's look at the request again: "model: 'gemini-2.5-flash'". I will use that.
  # Update: User prompt said "gemini-2.5-flash".
  temperature: 0.2
  max_output_tokens: 1200
  timeout_s: 60
  max_retries: 5

pcn:
  top_n: 10
  max_rounds: 2                 # negotiation rounds (keep small)
  candidate_window: 80          # only show top-30 candidates to LLM (token control)
  require_verifier_pass: true   # if fail, fall back to MMR or best-effort fix

constraints:
  popularity:
    max_head_in_topn: 4         # example: at most 4 “head” items in top-10
    min_tail_in_topn: 2         # at least 2 “tail” items in top-10
  diversity:
    min_unique_genres_in_topn: 3
  safety:
    no_duplicates: true

baselines:
  single_llm:
    enabled: true
  mmr_fallback:
    enabled: true

run:
  run_id: null
